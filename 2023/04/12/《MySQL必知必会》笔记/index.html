<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="《MySQL必知必会》笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="《MySQL必知必会》笔记">
<meta property="og:url" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Tien&#39;s Blog">
<meta property="og:description" content="《MySQL必知必会》笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205210313527.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205211103262.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205211621835.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206135900369.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206140032089.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206140053391.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206141025622.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206141447396.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230207163251844.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230207171628475.png">
<meta property="og:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230208101639289.png">
<meta property="article:published_time" content="2023-04-12T00:56:54.000Z">
<meta property="article:modified_time" content="2023-04-12T01:28:52.876Z">
<meta property="article:author" content="Tien">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205210313527.png">

<link rel="canonical" href="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>《MySQL必知必会》笔记 | Tien's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Tien's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section">首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section">标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section">分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section">归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/account">
      <meta itemprop="name" content="Tien">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tien's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          《MySQL必知必会》笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-04-12 08:56:54 / 修改时间：09:28:52" itemprop="dateCreated datePublished" datetime="2023-04-12T08:56:54+08:00">2023-04-12</time>
            </span>

          
            <div class="post-description">《MySQL必知必会》笔记</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="1-7章"><a href="#1-7章" class="headerlink" title="1-7章"></a>1-7章</h2><p>主键：一列（多列组合），其值能唯一区分表中每个行</p>
<p>主键值规则：任意两行不具有相同的主键值；主键列不允许NULL值</p>
<p>创建数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE db;</span><br></pre></td></tr></table></figure>

<p>选择数据库 USE语句</p>
<p>显示信息 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span><span class="keyword">SHOW</span>语句</span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;<span class="operator">/</span><span class="operator">/</span>获得数据库表</span><br><span class="line"><span class="keyword">SHOW</span> TABLES;<span class="operator">/</span><span class="operator">/</span>获得数据库内的表</span><br><span class="line"><span class="keyword">SHOW</span> COLUMNS <span class="keyword">FROM</span> table1;<span class="operator">/</span><span class="operator">/</span>显示表列</span><br><span class="line"><span class="keyword">SHOW</span> STATUS;<span class="operator">/</span><span class="operator">/</span>显示广泛的服务器状态信息</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>检索信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span><span class="keyword">SELECT</span>语句，给出想选择什么，从什么地方选</span><br><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name,prod_price <span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> products;</span><br></pre></td></tr></table></figure>

<p>检索不同数据，只返回不同的值，DISTINCT关键字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> vend_id <span class="keyword">FROM</span> products;</span><br></pre></td></tr></table></figure>

<p>限制检索结果，LIMIT子句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products LIMIT <span class="number">5</span>;<span class="operator">/</span><span class="operator">/</span>前<span class="number">5</span>行</span><br><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products LIMIT <span class="number">5</span>,<span class="number">5</span>;<span class="operator">/</span><span class="operator">/</span>从第<span class="number">5</span>行开始返回<span class="number">5</span>行</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>没有足够的行只返回能返回的所有行</span><br></pre></td></tr></table></figure>

<p>排序，ORDER BY子句，默认升序，LIMIT子句要在ORDER BY之后</p>
<p>DESC关键字降序排列，只应用于其之前的列名，想在多个列降序，需要对每个列指定DESC关键字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_price,prod_name <span class="keyword">FROM</span> products <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price,prod_name;<span class="operator">/</span><span class="operator">/</span>按多个列排序，按照<span class="keyword">ORDER</span> <span class="keyword">BY</span>规定的顺序排序</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_price,prod_name <span class="keyword">FROM</span> products <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>,prod_name;</span><br></pre></td></tr></table></figure>

<p>WHERE子句指定搜索条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name,prod_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_price<span class="operator">=</span><span class="number">2.50</span>;</span><br></pre></td></tr></table></figure>

<p>BETWEEN AND关键字：在指定的两个值之间（闭区间）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_price <span class="keyword">BETWEEN</span> <span class="number">5</span> <span class="keyword">AND</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>空值：NULL，用IS NULL检查</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id <span class="keyword">FROM</span> customers <span class="keyword">WHERE</span> cust_email <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>WHERE子句可以通过AND或OR组合</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> vend_id<span class="operator">=</span><span class="number">1003</span> <span class="keyword">AND</span> prod_price<span class="operator">&lt;=</span><span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> prod_name,prod_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> vend_id<span class="operator">=</span><span class="number">1002</span> <span class="keyword">OR</span> vend_id<span class="operator">=</span><span class="number">1003</span>;</span><br></pre></td></tr></table></figure>

<p><strong>AND优先级更高，先处理AND</strong></p>
<p>IN操作符，与OR功能相同但更直观，计算次序更清楚，比OR执行更快，可以包含其他SELECT子句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name,prod_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> vend_id <span class="keyword">IN</span> (<span class="number">1002</span>,<span class="number">1003</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p>NOT在WHERE子句中否定后跟条件</p>
<p>MySQL支持使用NOT对IN、BETWEEN和 EXISTS子句取反，这与多数其他DBMS允许使用NOT对各种条件 取反有很大的差别</p>
<h2 id="第8章-用通配符进行过滤"><a href="#第8章-用通配符进行过滤" class="headerlink" title="第8章 用通配符进行过滤"></a>第8章 用通配符进行过滤</h2><p>通配符（wildcard）用来匹配值的一部分特殊字符</p>
<p>搜索模式（search pattern）由字面值、通配符或两者组合构成的搜索条件。（如’jet%’，’%anvil%’）</p>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="%通配符"></a>%通配符</h3><p>%通配符表示任何字符出现任意次数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;jet%&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>找出所有以jet开头的</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;%anvil%&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>所有包含anvil的</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;s%e&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>所有以s开头以e结尾的</span><br></pre></td></tr></table></figure>

<p><strong>%通配符不能匹配NULL</strong></p>
<h3 id="下划线通配符"><a href="#下划线通配符" class="headerlink" title="下划线通配符"></a>下划线通配符</h3><p>_通配符与%用途一样，但<strong>只匹配单个字符</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;_ ton anvil&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h3><ul>
<li>不要过度使⽤通配符。如果其他操作符能达到相同的⽬的，应该使⽤其他操作符。 </li>
<li>在确实需要使⽤通配符时，除⾮绝对有必要，即使在有必要的情况下也不要把它们⽤在搜索模式的开始处。 </li>
<li>把通配符置于搜索模式的开始处，搜索起来是最慢的，因为这样就是全⽂检索了。（比如%jet会对每个对象一直匹配至最后几个字符才会比较jet）</li>
</ul>
<h2 id="第9章-正则表达式进行搜索"><a href="#第9章-正则表达式进行搜索" class="headerlink" title="第9章 正则表达式进行搜索"></a>第9章 正则表达式进行搜索</h2><p>正则表达式的作用是匹配文本，将一个模式（正则表达式）与一个文本串进行比较。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;1000&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;<span class="operator">/</span><span class="operator">/</span>prod_name包含<span class="number">1000</span>的所有行</span><br></pre></td></tr></table></figure>

<p><strong>REGEXP</strong>告诉SQL后面跟的东西作为正则表达式处理。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;1000&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">&#x27;1000&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p>第一句会返回一行，第二句不返回数据</p>
<p>因为LIKE匹配整个列（将搜索模式和整个列值做比较，找值等于1000的行），REGEXP在值内进行匹配（每个列值中包含搜索模式1000的行）</p>
<p>.匹配任意<strong>一个</strong>字符。</p>
<p><strong>OR匹配|：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;1000|2000&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p><strong>匹配几个字符之一[]：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;[123] Ton&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;<span class="operator">/</span><span class="operator">/</span>匹配prod_name中包含 <span class="number">1</span> ton<span class="operator">/</span><span class="number">2</span> ton<span class="operator">/</span><span class="number">3</span> ton的</span><br></pre></td></tr></table></figure>

<p>[123] Ton是[1|2|3] Ton的缩写，一定要把或的内容括在一个集合里，否则会应用于整个串</p>
<p>否定：[^123]匹配除这些字符外的任何东西</p>
<p><strong>匹配范围：</strong></p>
<p>使用-定义一个范围</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;[1-5] Ton&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p><strong>匹配特殊字符：</strong></p>
<p>使用\为前导</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name <span class="keyword">FROM</span> vendors <span class="keyword">WHERE</span> vend_name REGEXP <span class="string">&#x27;\.&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>

<p><strong>匹配字符类：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205210313527.png" alt="image-20230205210313527"></p>
<p><strong>匹配多个实例：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205211103262.png" alt="image-20230205211103262"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;\\([0-9] sticks?\\)&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p>说明：\\(匹配左括号，[0-9]匹配任意数字，s?匹配s出现0次或1次，也即stick或者sticks，\\)匹配右括号。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;[[:digit:]]&#123;4&#125;&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>

<p>说明：[:digit:]匹配任意数字，{4}要求前面的字符出现4次，即任意4位数字。</p>
<p><strong>定位符：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230205211621835.png" alt="image-20230205211621835"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_name REGEXP <span class="string">&#x27;^[0-9\\.]&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;、、匹配以数字和小数点开头的所有产品</span><br></pre></td></tr></table></figure>

<p><strong>^在集合中表示否定该集合，在集合外表示文本开始处的定位符</strong></p>
<p><strong>利用定位符，通过用^开始每个表达式，用$结束每个表达式，可以使 REGEXP的作用与LIKE一样（LIKE匹配整个串，REGEXP匹配子串）</strong></p>
<h2 id="第10章-创建计算字段"><a href="#第10章-创建计算字段" class="headerlink" title="第10章 创建计算字段"></a>第10章 创建计算字段</h2><p>只有数据库知道SELECT语句中哪些列是实际的表列，哪些列是计算字段。从客户机（如应用程序）的角度来看，计算字段的数据是以与其他列的数据相同的方式返回的。</p>
<p><strong>拼接，将值联结到一起构成单个值</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Concat(vend_name,<span class="string">&#x27;(&#x27;</span>,vend_country,<span class="string">&#x27;)&#x27;</span>) <span class="keyword">FROM</span> vendors <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>

<p><strong>多数DBMS使用+或||来实现拼接， MySQL则使用Concat()函数来实现。</strong></p>
<p>**Trim() LTrim() RTrim()**去除值左右的空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Concat(RTrim(vend_name),<span class="string">&#x27;(&#x27;</span>,RTrim(vend_country),<span class="string">&#x27;)&#x27;</span>) <span class="keyword">FROM</span> vendors <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>

<p><strong>AS关键字赋予别名（导出列）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Concat(vend_name,<span class="string">&#x27;(&#x27;</span>,vend_country,<span class="string">&#x27;)&#x27;</span>) <span class="keyword">AS</span> vend_title <span class="keyword">FROM</span> vendors <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>

<p>任何客户机应用都可以按名引用 这个列，就像它是一个实际的表列一样</p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206135900369.png" alt="image-20230206135900369"></p>
<h2 id="第11章-使用数据处理函数"><a href="#第11章-使用数据处理函数" class="headerlink" title="第11章 使用数据处理函数"></a>第11章 使用数据处理函数</h2><p><strong>文本处理函数：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206140032089.png" alt="image-20230206140032089"></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206140053391.png" alt="image-20230206140053391"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, <span class="built_in">Upper</span>(vend_name) <span class="keyword">AS</span> vend_name_upcase <span class="keyword">FROM</span> vendors <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>

<p>Soundex()是一个将任何文本串转换为描述其语音表示的字母数字模式的算法，主要目的是根据声音比较字符串之间的相似性。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Soundex(<span class="string">&#x27;sea&#x27;</span>) <span class="keyword">AS</span> sea_soundex, Soundex(<span class="string">&#x27;see&#x27;</span>) <span class="keyword">AS</span>  see_soundex;<span class="operator">/</span><span class="operator">/</span>均为<span class="number">5000</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name,cust_contact <span class="keyword">FROM</span> customers <span class="keyword">WHERE</span> Soundex(cust_contact) <span class="operator">=</span> Soundex(<span class="string">&#x27;Y Lie&#x27;</span>);<span class="operator">/</span><span class="operator">/</span>返回Y Lee一行</span><br></pre></td></tr></table></figure>

<p><strong>日期和时间处理函数：</strong></p>
<p>日期和时间采用相应的数据类型和特殊的格式存储，应用程序一般不使用用来存储日期和时间的格式，因此日期和时间函数总是被用来读取、统计和处理这些值。</p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206141025622.png" alt="image-20230206141025622"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id,order_num <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> <span class="type">Date</span>(order_date)<span class="operator">=</span><span class="string">&#x27;2005-09-01&#x27;</span></span><br></pre></td></tr></table></figure>

<p>应该总是使用yyyy-mm-dd格式，如果需要日期则使用Date()，即便知道相应的列只包含日期</p>
<p>检索某一段日期的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id,order_num <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> <span class="type">Date</span>(order_date) <span class="keyword">BETWEEN</span> <span class="string">&#x27;2005-09-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2005-09-30&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> cust_id,order_num <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> <span class="keyword">Year</span>(order_date)<span class="operator">=</span><span class="number">2005</span> <span class="keyword">AND</span> <span class="keyword">Month</span>(order_date)<span class="operator">=</span><span class="number">9</span>;</span><br></pre></td></tr></table></figure>

<p><strong>数值处理函数：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230206141447396.png" alt="image-20230206141447396"></p>
<h2 id="第12章-汇总数据"><a href="#第12章-汇总数据" class="headerlink" title="第12章 汇总数据"></a>第12章 汇总数据</h2><h3 id="AVG"><a href="#AVG" class="headerlink" title="AVG()"></a>AVG()</h3><p>对表中特定列或特定行的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(prod_price) <span class="keyword">AS</span> avg_price <span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(prod_price) <span class="keyword">AS</span> avg_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> vend_id<span class="operator">=</span><span class="number">1003</span>;</span><br></pre></td></tr></table></figure>

<p>对多个列分别求平均值需要使用多个AVG()函数</p>
<h3 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT()"></a>COUNT()</h3><p>计数</p>
<p>COUNT(*)对行数目进行计数</p>
<p>COUNT(column)对列中有值的进行计数，<strong>忽略NULL</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(cust_email) <span class="keyword">AS</span> num_cust <span class="keyword">FROM</span> customers;</span><br></pre></td></tr></table></figure>

<h3 id="MAX-x2F-MIN"><a href="#MAX-x2F-MIN" class="headerlink" title="MAX()&#x2F;MIN()"></a>MAX()&#x2F;MIN()</h3><p>要求指定列名，<strong>忽略NULL</strong></p>
<h3 id="SUM"><a href="#SUM" class="headerlink" title="SUM()"></a>SUM()</h3><p>返回指定列值的总和，也可以合计 计算值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(quantity) <span class="keyword">AS</span> items_ordered <span class="keyword">FROM</span> orderitems <span class="keyword">WHERE</span> order_num<span class="operator">=</span><span class="number">20005</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(item_price<span class="operator">*</span>quantity) <span class="keyword">AS</span> total_price <span class="keyword">FROM</span> orderitems <span class="keyword">WHERE</span> order_num<span class="operator">=</span><span class="number">20005</span>;</span><br></pre></td></tr></table></figure>

<h3 id="聚集不同值"><a href="#聚集不同值" class="headerlink" title="聚集不同值"></a>聚集不同值</h3><p>在上述函数中使用DISTINCT关键字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(<span class="keyword">DISTINCT</span> prod_price) <span class="keyword">AS</span> avg_price <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> vend_id<span class="operator">=</span><span class="number">1003</span>;</span><br></pre></td></tr></table></figure>

<p><strong>DISTINCT只能用于列名，不能用于计算或表达式</strong></p>
<h2 id="第13章-分组数据"><a href="#第13章-分组数据" class="headerlink" title="第13章 分组数据"></a>第13章 分组数据</h2><p>GROUP BY子句创建分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_prods <span class="keyword">FROM</span> products <span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id;</span><br></pre></td></tr></table></figure>

<ul>
<li>除聚集计算语句外，SELECT语句中的每个列都必须在GROUP BY子句中给出。</li>
<li>如果分组列中具有NULL值，则NULL将作为一个分组返回。如果列 中有多行NULL值，它们将分为一组。</li>
<li>GROUP BY子句必须出现在WHERE子句之后，ORDER BY子句之前。</li>
<li>GROUP BY子句可以包含任意数目的列。</li>
</ul>
<p>HAVING子句过滤分组</p>
<p><strong>WHERE过滤的是行，HAVING过滤的是分组，（WHERE在分组前过滤数据，HAVING在分组后过滤数据）HAVING支持所有WHERE操作符</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> orders <span class="keyword">FROM</span> orders <span class="keyword">GROUP</span> <span class="keyword">BY</span> cust_id <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">SELECT</span> vend_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_prods <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_price<span class="operator">&lt;=</span><span class="number">10</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;=</span><span class="number">2</span>;<span class="operator">/</span><span class="operator">/</span>有<span class="number">2</span>个以上价格为<span class="number">10</span>以上的产品的供应商，返回 <span class="number">1003</span> <span class="number">4</span>、<span class="number">1005</span> <span class="number">2</span>两组</span><br><span class="line"><span class="keyword">SELECT</span> vend_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_prods <span class="keyword">FROM</span> products <span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;=</span><span class="number">2</span>;<span class="operator">/</span><span class="operator">/</span>返回四组，没有过滤价格为<span class="number">10</span>以上</span><br></pre></td></tr></table></figure>

<h2 id="第14章-使用子查询"><a href="#第14章-使用子查询" class="headerlink" title="第14章 使用子查询"></a>第14章 使用子查询</h2><p>一般来说子查询最好不要嵌套太多层</p>
<h2 id="第15章-联结表"><a href="#第15章-联结表" class="headerlink" title="第15章 联结表"></a>第15章 联结表</h2><p>关系表的设计就是要保证把信息分解成多个表，一类数据 一个表。各表通过某些常用的值（即关系设计中的关系（relational））互相关联。</p>
<p>外键为某个表中的一列，它包含另一个表的主键值，定义了两个表之间的关系。</p>
<p>使用联结可以将储存在多个表中的数据通过单条SELECT语句检索出，联结不是物理实体，存在于查询的执行当中。</p>
<p>创建联结：规定要联结的所有表以及如何关联即可：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name,prod_name,prod_price <span class="keyword">FROM</span> vendors,products <span class="keyword">WHERE</span> vendors.vend_id<span class="operator">=</span>products.vend_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name,prod_name;</span><br></pre></td></tr></table></figure>

<p>vend_name在一个表中，prod_name和prod_price在另一个表中；WHERE子句联结两个表，这里需要完全限定列名，避免出现二义性。<strong>应该保证所有联结都有正确的WHERE子句。</strong></p>
<p>以下内部联结语法返回同样的内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name,prod_name,prod_price <span class="keyword">FROM</span> vendors <span class="keyword">INNER</span> <span class="keyword">JOIN</span> products <span class="keyword">ON</span> vendors.vend_id<span class="operator">=</span>products.vend_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name,prod_name;</span><br></pre></td></tr></table></figure>

<p>联结表的数目没有限制，基本规则也相同，首先列出所有表，然后定义表之间的关系</p>
<p><strong>但是不要联结不必要的表，联结越多性能下降越多。</strong></p>
<h2 id="第16章-创建高级联结"><a href="#第16章-创建高级联结" class="headerlink" title="第16章 创建高级联结"></a>第16章 创建高级联结</h2><p><strong>使用表别名：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,cust_concat <span class="keyword">FROM</span> customers <span class="keyword">AS</span> c, orders <span class="keyword">AS</span> o,orderitems <span class="keyword">AS</span> oi <span class="keyword">WHERE</span> c.cust_id<span class="operator">=</span>o.cust_id <span class="keyword">AND</span> oi.order_num<span class="operator">=</span>o.order_num <span class="keyword">AND</span> prod_id<span class="operator">=</span><span class="string">&#x27;TNT2&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>自联结：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>查找ID为DTNTR物品的供应商生产的其他物品</span><br><span class="line"><span class="keyword">SELECT</span> prod_id,prod_name <span class="keyword">FROM</span> products WHRER vend_id<span class="operator">=</span>(<span class="keyword">SELECT</span> vend_id <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_id<span class="operator">=</span><span class="string">&#x27;DTNTR&#x27;</span>);<span class="operator">/</span><span class="operator">/</span>子查询</span><br><span class="line"><span class="keyword">SELECT</span> p1.prod_id,p1.prod_name <span class="keyword">FROM</span> products <span class="keyword">AS</span> p1,products <span class="keyword">AS</span> p2 <span class="keyword">WHERE</span> p1.vend_id<span class="operator">=</span>p2.vend_id <span class="keyword">AND</span> p2.prod_id<span class="operator">=</span><span class="string">&#x27;DTNTR&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>自联结查询，别名表解决二义性问题</span><br></pre></td></tr></table></figure>

<p>有时候处理联结远比处理子查询快得多。应该试一 下两种方法，以确定哪一种的性能更好。</p>
<p><strong>自然联结：</strong></p>
<p>标准的联结（前一章中介绍的内部联结）返回所有数据，甚至相同的列多次出现。<strong>自然联结排除多次出现，使每个列只返回一次。</strong></p>
<p><strong>外部联结：</strong></p>
<p>内部联结关联两个表中有关系的行，外部联结还包括没有关联的行</p>
<p>使用OUTER JOINT时必须用RIGHT或LEFT指定包括其所有行的表，RIGHT指出右边的表包含所有行，LEFT指出左边。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> customers.cust_id,orders.order_num <span class="keyword">FROM</span> customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id <span class="operator">=</span> orders.cust_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> customers.cust_name,customers.cust_id,<span class="built_in">COUNT</span>(orders.order_num) <span class="keyword">AS</span> num_ord <span class="keyword">FROM</span> customers <span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id <span class="operator">=</span> orders.cust_id <span class="keyword">GROUP</span> <span class="keyword">BY</span> customers.cust_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> customers.cust_name,customers.cust_id,<span class="built_in">COUNT</span>(orders.order_num) <span class="keyword">AS</span> num_ord <span class="keyword">FROM</span> customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> orders <span class="keyword">ON</span> customers.cust_id <span class="operator">=</span> orders.cust_id <span class="keyword">GROUP</span> <span class="keyword">BY</span> customers.cust_id;</span><br></pre></td></tr></table></figure>

<h2 id="第17章-组合查询"><a href="#第17章-组合查询" class="headerlink" title="第17章 组合查询"></a>第17章 组合查询</h2><p>UNION规则：</p>
<ul>
<li>UNION必须由两条或两条以上的SELECT语句组成，语句之间用关键字UNION分隔</li>
<li>UNION中的每个查询必须包含相同的列、表达式或聚集函数</li>
<li>列数据类型必须兼容：类型不必完全相同，但必须是DBMS可以隐含地转换的类型</li>
</ul>
<p>UNION从查询结果集中自动去除重复的行，如果要保留可以使用UNION ALL</p>
<p><strong>在用UNION组合查询时，只 能使用一条ORDER BY子句，它必须出现在最后一条SELECT语句之后，但用来排序所有SELECT语句返回的结果</strong></p>
<h2 id="第18章-全文本搜索"><a href="#第18章-全文本搜索" class="headerlink" title="第18章 全文本搜索"></a>第18章 全文本搜索</h2><p><strong>并非所有引擎都支持全文本搜索，InnoDB不支持但MyISAM支持</strong></p>
<p>一般在创建表时启用全文本搜索。CREATE TABLE语句接受FULLTEXT子句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> productnotes</span><br><span class="line">(</span><br><span class="line">    note_id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO INCREMENT,</span><br><span class="line">    prod_id <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    note_date datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    note_text text <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(note_id),</span><br><span class="line">    FULLTEXT(note_text)</span><br><span class="line">)ENGINE<span class="operator">=</span>MyISAM;</span><br></pre></td></tr></table></figure>

<p><strong>不要在导入数据时使用FULLTEXT</strong>. 更新索引要花时间，如果正在导入数据到一个新表，此时不应该启用FULLTEXT索引。应该首先导入所有数据，然 后再修改表，定义FULLTEXT。</p>
<p>索引之后使用Match()和Against()执行全文本搜索，前者指定被搜索的列，后者指定要使用的搜索表达式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text) Against(<span class="string">&#x27;rabbit&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230207163251844.png" alt="image-20230207163251844"></p>
<p>两行含有rabbit，被返回</p>
<p><strong>传递给Match()的值必须和FULLTEXT()中定义的相同，如果指定多个列必须列出它们且次序正确</strong></p>
<p>全文本搜索结果的排序返回以文本匹配的良好程度决定</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text, <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;rabbit&#x27;</span>) <span class="keyword">AS</span> score <span class="keyword">FROM</span> productnotes;</span><br></pre></td></tr></table></figure>

<p>Match(note_text)Against(‘rabbit’)建立了一个计算列包含全文本搜索计算出的匹配度，该得分由行中词的数目、唯一词的数目、整个索引中词的数目以及包含该词的行的数目计算得出。</p>
<p><strong>查询扩展（version&gt;&#x3D;4.1.1）：</strong></p>
<p>举例：找出包含词anvils的注释与其他有关行（可能不包含该词）</p>
<p>MySQL执行过程：</p>
<ul>
<li>执行一个基本的全文本搜索，找出所有匹配搜索条件的行</li>
<li>检查这些行选择所有有用的词</li>
<li>用原来条件+有用的词再执行一次全文本搜索</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text) Against(<span class="string">&#x27;anvils&#x27;</span> <span class="keyword">WITH</span> QUERY EXPANSION);</span><br></pre></td></tr></table></figure>

<p>查询扩展极大地增加了返回的行数，但这样做也增加了 你实际上并不想要的行的数目。</p>
<p>表中的行越多（这些行中的文本就越多），使用查询扩展返回的结果越好。</p>
<p><strong>布尔文本搜索：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;heavy -rope*&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>匹配包含heavy但不包含任意以rope开始的词的行</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230207171628475.png" alt="image-20230207171628475"></p>
<p><strong>在布尔方式中，不按等级值降序排序返回的行</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;+rabbit +bait&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>包含rabbit和bait的行</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;rabbit bait&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>包含rabbit或bait的行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;&quot;rabbit bait&quot;&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>包含短语rabbit bait的行</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;&gt;rabbit &lt;bait&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>包含rabbit或bait的行，前者优先级提高，后者优先级降低</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> note_text <span class="keyword">FROM</span> productnotes <span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text)Against(<span class="string">&#x27;+safe +(&lt;companion)&#x27;</span> <span class="keyword">IN</span> <span class="type">BOOLEAN</span> MODE);<span class="operator">/</span><span class="operator">/</span>包含safe和companion的行，前者优先级提高，后者优先级降低</span><br></pre></td></tr></table></figure>

<h2 id="第19章-插入数据"><a href="#第19章-插入数据" class="headerlink" title="第19章 插入数据"></a>第19章 插入数据</h2><p><strong>插入完整的行：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;Pep E. LaPew&#x27;</span>,<span class="string">&#x27;100 Main Street&#x27;</span>,<span class="string">&#x27;Los Angeles&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>,<span class="string">&#x27;90046&#x27;</span>,<span class="string">&#x27;USA&#x27;</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<p><strong>各个列必须以它们在表定义中出现的次序填充</strong></p>
<p>上面语法简单但并不安全，高度依赖表中列的定义次序，更安全的方法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_address,cust_city,cust_state,cust_zip,cust_country,cust_contact,cust_email) </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;Pep E. LaPew&#x27;</span>,<span class="string">&#x27;100 Main Street&#x27;</span>,<span class="string">&#x27;Los Angeles&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>,<span class="string">&#x27;90046&#x27;</span>,<span class="string">&#x27;USA&#x27;</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<p>MySQL将用VALUES列表中的相应值填入列表中的对应项</p>
<p>如果列定义为允许NULL值切表定义中给出默认值，则在插入操作中可以省略这些列。</p>
<p>INSERT LOW-PRIORITY INTO可以降低插入的优先级</p>
<p><strong>插入多个行：</strong></p>
<p>VALUES中间用逗号分隔，每组值用一对圆括号括起来</p>
<p><strong>单条语句多个插入比使用多条语句快</strong></p>
<p><strong>插入检索出的数据：</strong></p>
<p>将SELECT语句的结果插入表中</p>
<p>假设想从另一个表中的客户列表合并到现有的customers表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers(...) <span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> custnew;</span><br></pre></td></tr></table></figure>

<p>…中的列名不一定要求匹配，两个位置的…分别对应</p>
<h2 id="第20章-更新和删除数据"><a href="#第20章-更新和删除数据" class="headerlink" title="第20章 更新和删除数据"></a>第20章 更新和删除数据</h2><p>UPDATE语句更新表中所有行或特定行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> customers <span class="keyword">SET</span> cust_email<span class="operator">=</span><span class="string">&#x27;elmer@fudd.com&#x27;</span>,cust_name<span class="operator">=</span><span class="string">&#x27;The Fudds&#x27;</span> <span class="keyword">WHERE</span> cust_id<span class="operator">=</span><span class="number">10005</span>;</span><br></pre></td></tr></table></figure>

<p>以要更新的表名开始，SET赋新值，WHERE指定要更新的行</p>
<p>UPDATE IGNORE可以在更新多行时即便发生错误也可以继续更新</p>
<p>DELETE从表中删除行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> customers <span class="keyword">WHERE</span> cust_id<span class="operator">=</span><span class="number">10006</span>;</span><br></pre></td></tr></table></figure>

<p>如果要删除表中所有行，可以使用TRUNCATE TABLE语句，该语句删除原来的表并重新创建一个，所以速度更快。</p>
<h2 id="第21章-创建和操纵表"><a href="#第21章-创建和操纵表" class="headerlink" title="第21章 创建和操纵表"></a>第21章 创建和操纵表</h2><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">(</span><br><span class="line">    cust_id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    cust_name <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    cust_address <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_city <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_state <span class="type">char</span>(<span class="number">5</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_zip <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_country <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_contact <span class="type">char</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    cust_email <span class="type">char</span>(<span class="number">255</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (cust_id)</span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure>

<p>主键必须唯一，如果使用单个列则值必须唯一；如果使用多个列则列的组合值必须唯一，主键不允许NULL值的列。</p>
<p>AUTO_INCREMENT告诉MySQL，本列每增加一行时自动对该列增量赋予该行一个可用值。</p>
<p><strong>每个表只允许一个AUTO_INCREMENT列，而且必须被索引（如，通 过使它成为主键）</strong></p>
<p>获得AUTO_INCREMENT列的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_insert_id();</span><br></pre></td></tr></table></figure>

<p><strong>指定默认值：</strong></p>
<p>在CREATE TABLE时列定义中用DEFAULT关键字指定</p>
<p><strong>与大多数DBMS不一样，MySQL不允许使用函数作为默认值，它只支持常量。</strong></p>
<p><strong>引擎类型：</strong></p>
<p><img src="/2023/04/12/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E7%AC%94%E8%AE%B0/image-20230208101639289.png" alt="image-20230208101639289"></p>
<p><strong>外键不能跨引擎，即使用一个引擎的表不能引用使用不同引擎的表的外键</strong></p>
<h3 id="更新表"><a href="#更新表" class="headerlink" title="更新表"></a>更新表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors <span class="keyword">ADD</span> vend_phone <span class="type">CHAR</span>(<span class="number">20</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> vend_phone <span class="type">CHAR</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p>ALTER TABLE之后给出要改的表名，所做更改的列表</p>
<p>ALTER TABLE定义外键：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orderitems_orders <span class="keyword">FOREIGN</span> KEY(order_num) <span class="keyword">REFERENCES</span> orders;</span><br></pre></td></tr></table></figure>

<p><strong>使用ALTER TABLE要极为小心，应该在进行改动前做一个完整的备份</strong></p>
<h3 id="删除表、重命名表"><a href="#删除表、重命名表" class="headerlink" title="删除表、重命名表"></a>删除表、重命名表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> customers2;</span><br><span class="line">RENAME <span class="keyword">TABLE</span> customers2 <span class="keyword">TO</span> custermers, customers3 <span class="keyword">TO</span> custmers;</span><br></pre></td></tr></table></figure>

<h2 id="第22章-使用视图（-gt-x3D-MySQL-5）"><a href="#第22章-使用视图（-gt-x3D-MySQL-5）" class="headerlink" title="第22章 使用视图（&gt;&#x3D; MySQL 5）"></a>第22章 使用视图（&gt;&#x3D; MySQL 5）</h2><p>视图是虚拟的表。与包含数据的表不一样，<strong>视图只包含使用时动态检索数据的查询。</strong></p>
<h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,cust_contact <span class="keyword">FROM</span> customers,orders,orderitems <span class="keyword">WHERE</span> customers.cust_id<span class="operator">=</span>orders.cust_id <span class="keyword">AND</span> orderitems.order_num<span class="operator">=</span>orders.order_num <span class="keyword">AND</span> prod_id<span class="operator">=</span><span class="string">&#x27;TNT2&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>该查询检索订购了某个特定产品的用户。</p>
<p>如果把整个查询包装成一个虚拟表名为productcustomers，则检索相同数据的语句可以写成：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,cust_contact <span class="keyword">FROM</span> productcustomers <span class="keyword">WHERE</span> prod_id<span class="operator">=</span><span class="string">&#x27;TNT2&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>视图本身不包含数据，在添加或更改底层表中的数据时，视图将返回改变后的数据</strong></p>
<h3 id="规则和限制"><a href="#规则和限制" class="headerlink" title="规则和限制"></a>规则和限制</h3><ul>
<li>唯一命名。</li>
<li>必须具有足够的访问权限才能创建视图。</li>
<li>可以嵌套。</li>
<li>ORDER BY可以用在视图中，但如果从该视图检索数据SELECT中也 含有ORDER BY，那么该视图中的ORDER BY将被覆盖。</li>
<li>不能索引，也不能有关联的触发器或默认值</li>
<li>可以和表一起使用。例如，编写一条联结表和视图的SELECT 语句。</li>
</ul>
<h3 id="使用视图"><a href="#使用视图" class="headerlink" title="使用视图"></a>使用视图</h3><ul>
<li>CREATE VIEW创建视图</li>
<li>DROP VIEW删除视图</li>
<li>SHOW CREATE VIEW查看创建视图的语句</li>
<li>更新视图时可以先DROP再CREATE，也可直接用CREATE OR REPLACE VIEW</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW productcustomers AS </span><br><span class="line">SELECT cust_name,cust_contact FROM customers,orders,orderitems WHERE customers.cust_id=orders.cust_id AND orderitems.order_num=orders.order_num AND prod_id=&#x27;TNT2&#x27;;</span><br></pre></td></tr></table></figure>

<p>可以对视图进行更新（INSERT&#x2F;UPDATE&#x2F;DELETE），其实是对其基表进行更新</p>
<p>但是如果视图定义中有<strong>分组、联结、子查询、并、聚集函数、DISTINCT、导出列</strong>则不能更新视图（MySQL5中）</p>
<h2 id="第23章-使用存储过程-MySQL5"><a href="#第23章-使用存储过程-MySQL5" class="headerlink" title="第23章 使用存储过程(MySQL5)"></a>第23章 使用存储过程(MySQL5)</h2><h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><p>存储过程简单来说，就是为以后的使用而保存 的一条或多条MySQL语句的集合。可将其视为批文件，虽然它们的作用不仅限于批处理。</p>
<p>执行存储过程（调用）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> productpricing(<span class="variable">@pricelow</span>,<span class="variable">@pricehigh</span>,<span class="variable">@priceaverage</span>);<span class="operator">/</span><span class="operator">/</span>计算并返回产品最低、最高、平均价格</span><br></pre></td></tr></table></figure>

<p>创建存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> productpricing()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(prod_price) <span class="keyword">AS</span> priceaverage <span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p><strong>在命令行执行上述过程可以先用DELIMITER &#x2F;&#x2F;更改分隔符为&#x2F;&#x2F;，这样可以保留存储过程中的分号</strong></p>
<p>删除存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> productpricing;</span><br></pre></td></tr></table></figure>

<h3 id="使用参数"><a href="#使用参数" class="headerlink" title="使用参数"></a>使用参数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> productpricing(<span class="keyword">OUT</span> pl <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>),</span><br><span class="line">                               <span class="keyword">OUT</span> ph <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>),</span><br><span class="line">                               <span class="keyword">OUT</span> pa <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(prod_price) <span class="keyword">INTO</span> pL</span><br><span class="line">	<span class="keyword">FROM</span> products;</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(prod_price) <span class="keyword">INTO</span> ph</span><br><span class="line">	<span class="keyword">FROM</span> products;</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(prod_price) <span class="keyword">INTO</span> pa</span><br><span class="line">	<span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>也可以使用IN参数传入</p>
<h2 id="第24章-使用游标（MySQL5）"><a href="#第24章-使用游标（MySQL5）" class="headerlink" title="第24章 使用游标（MySQL5）"></a>第24章 使用游标（MySQL5）</h2><p>有时，需要在检索出来的行中前进或后退一行或多行。这就是使用 游标的原因。游标（cursor）是一个存储在MySQL服务器上的数据库查询， 它不是一条SELECT语句，而是被该语句检索出来的结果集。在存储了游 标之后，应用程序可以根据需要滚动或浏览其中的数据。</p>
<h2 id="第25章-使用触发器（MySQL5）"><a href="#第25章-使用触发器（MySQL5）" class="headerlink" title="第25章 使用触发器（MySQL5）"></a>第25章 使用触发器（MySQL5）</h2><p>想要某条语句（或某些语句）在事件发生时自动执行（如每当增加一个顾客到某个数据库表时，都检查其电话号码格式是否正确）</p>
<p>触发器是MySQL响应<strong>DELETE&#x2F;INSERT&#x2F;UPDATE语句</strong>而自动执行的一条MySQL语句（或位于BEGIN和END语句之间的一组语句）</p>
<h3 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h3><p><strong>需要给出信息：唯一的触发器名、触发器关联的表、触发器应该相应的活动、触发器何时执行</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> newproduct AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> products <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="keyword">SELECT</span> <span class="string">&#x27;Product added&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>代码对每个插入行执行，显示Product added</p>
<p><strong>视图不支持触发器</strong></p>
<p><strong>每个表每个事件每次只允许一个触发器，因此每个表最多支持6个触发器</strong></p>
<p><strong>如果BEFORE触发器失败，则MySQL将不执行请求的操作。此外，如果BEFORE触发器或语句本身失败，MySQL 将不执行AFTER触发器（如果有的话）</strong></p>
<h3 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> newproduct;</span><br></pre></td></tr></table></figure>

<p>触发器不能更新或覆盖。为了修改一个触发器，必须先删除它， 然后再重新创建</p>
<h3 id="使用触发器"><a href="#使用触发器" class="headerlink" title="使用触发器"></a>使用触发器</h3><p><strong>INSERT触发器</strong>在INSERT语句执行之前或之后执行。需要知道以下几点：</p>
<ul>
<li>在INSERT触发器代码内，可引用一个名为NEW的虚拟表，访问被插入的行</li>
<li>在BEFORE INSERT触发器中，NEW中的值也可以被更新（允许更改被插入的值）</li>
<li>对于AUTO_INCREMENT列，NEW在INSERT执行之前包含0，在INSERT执行之后包含新的自动生成值。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> neworder AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> orders <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="keyword">SELECT</span> NEW.order_num <span class="keyword">INTO</span> <span class="variable">@P</span>;</span><br></pre></td></tr></table></figure>

<p>创建触发器newoeder，在新数据插入到orders表后，MySQL生成一个新订单号保存到order_num中，触发器取得值并返回</p>
<p>MySQL5后触发器不支持返回结果集，需要用一个变量接收输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders(order_date, cust_id) <span class="keyword">VALUES</span>(NOW(), <span class="number">10001</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@p</span>;</span><br></pre></td></tr></table></figure>

<p>通常，将BEFORE用于数据验证和净化（目的是保证插入表中的数据确实是需要的数据）</p>
<p><strong>DELETE触发器</strong>在DELETE语句执行之前或之后执行。需要知道以下两点:</p>
<ul>
<li>在DELETE触发器代码内，你可以引用一个名为OLD的虚拟表，访问被删除的行</li>
<li>OLD中的值全都是只读的，不能更新</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> deleteorder BEFORE <span class="keyword">DELETE</span> <span class="keyword">ON</span> orders <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> archive_orders (order_num,order_date,cust_id) 					<span class="keyword">VALUES</span>(OLD.order_num,OLD.order_date, OLD.cust_id);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">from</span> orders <span class="keyword">where</span> <span class="keyword">YEAR</span>(order_date) <span class="operator">=</span> <span class="number">2019</span>;</span><br></pre></td></tr></table></figure>



<p><strong>UPDATE触发器</strong>在UPDATE语句执行之前或之后执行。需要知道以下几点:</p>
<ul>
<li>在UPDATE触发器代码中，你可以引用一个名为OLD的虚拟表访问以前（UPDATE语句前）的值，引用一个名为NEW的虚拟表访问新更新的值</li>
<li>在BEFORE UPDATE触发器中，NEW中的值可能也被更新（允许更改将要用于UPDATE语句中的值）；</li>
<li>OLD中的值全都是只读的，不能更新</li>
</ul>
<h2 id="第26章-管理事务处理"><a href="#第26章-管理事务处理" class="headerlink" title="第26章 管理事务处理"></a>第26章 管理事务处理</h2><p><strong>并非所有引擎都支持事务处理</strong></p>
<p>事务处理（transaction processing）可以用来维护数据库的完整性，它保证成批的MySQL操作要么完全执行，要么完全不执行</p>
<p>MySQL使用下面语句标识事务开始</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> ordertotals;<span class="operator">/</span><span class="operator">/</span>不为空</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;<span class="operator">/</span><span class="operator">/</span>开始事务</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> ordertotals;<span class="operator">/</span><span class="operator">/</span>清空该表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> ordertotals;<span class="operator">/</span><span class="operator">/</span>表为空</span><br><span class="line"><span class="keyword">ROLLBACK</span>;<span class="operator">/</span><span class="operator">/</span>回退</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> ordertotals;<span class="operator">/</span><span class="operator">/</span>回退后表不为空</span><br></pre></td></tr></table></figure>

<p>事务处理用来管理INSERT、UPDATE和 DELETE语句。不能回退SELECT语句。（这样做也没有什么意义。）不能回退CREATE或DROP操作。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;<span class="operator">/</span><span class="operator">/</span>开始事务</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> ordertotals;<span class="operator">/</span><span class="operator">/</span>清空该表</span><br><span class="line"><span class="keyword">COMMIT</span>;<span class="operator">/</span><span class="operator">/</span>提交事务</span><br></pre></td></tr></table></figure>

<p><strong>当COMMIT或ROLLBACK执行后，事务会自动关闭</strong></p>
<p>更复杂的事务处理可能需要部分提交或回退，这样做需要在事务处理块的合适位置放置占位符，如果需要回退可以回退到某个占位符。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SAVEPOINT</span> delete1;</span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> delete1;</span><br><span class="line"><span class="keyword">RELEASE</span> <span class="keyword">SAVEPOINT</span>;<span class="operator">/</span><span class="operator">/</span>释放保留点</span><br></pre></td></tr></table></figure>

<p>保留点越多越好 可以在MySQL代码中设置任意多的保留点，越多越好。为什么呢？因为保留点越多，就越能按意愿灵活地进⾏回退。</p>
<h2 id="第28章-安全管理"><a href="#第28章-安全管理" class="headerlink" title="第28章 安全管理"></a>第28章 安全管理</h2><p>MySQL用户账号和信息存储在名为mysql的MySQL数据库中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">CREATE</span> USED ben INDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;p@$$w0rd&#x27;</span>;</span><br><span class="line">RENAME <span class="keyword">USER</span> ben <span class="keyword">TO</span> bforta;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> bforta;</span><br></pre></td></tr></table></figure>

<h2 id="第29章-数据库维护"><a href="#第29章-数据库维护" class="headerlink" title="第29章 数据库维护"></a>第29章 数据库维护</h2><p>ANALYZE TABLE，用来检查表键是否正确</p>
<p>CHECK TABLE用来针对许多问题对表进行检查。在MyISAM表上还对 索引进行检查。CHECK TABLE支持一系列的用于MyISAM表的方式。 CHANGED检查自最后一次检查以来改动过的表。EXTENDED执行最彻底的检查，FAST只检查未正常关闭的表，MEDIUM检查所有被删 除的链接并进行键检验，QUICK只进行快速扫描。如下所示，CHECK TABLE发现和修复问题</p>
<h2 id="第30章-改善性能"><a href="#第30章-改善性能" class="headerlink" title="第30章 改善性能"></a>第30章 改善性能</h2><ul>
<li>如果你遇到显著的性能不良，可使用SHOW PROCESSLIST 显示所有活动进程（以及它们的线程ID和执行时间）。你还可以用KILL命令终结某个特定的进程（使用这个命令需要作为管理员登录）。</li>
<li>使用EXPLAIN语句让MySQL解释它将如何执行一条SELECT语句</li>
<li>一般来说，存储过程执行得比一条一条地执行其中的各条MySQL 语句快</li>
<li>决不要检索比需求还要多的数据。换言之，不要用SELECT *（除 非你真正需要每个列）</li>
<li>LIKE很慢。一般来说，最好是使用FULLTEXT而不是LIKE</li>
<li>你的SELECT语句中有一系列复杂的OR条件吗？通过使用多条 SELECT语句和连接它们的UNION语句，你能看到极大的性能改进</li>
<li>必须索引数据库表以改善数据检索的性能。确定索引什么不是一 件微不足道的任务，需要分析使用的SELECT语句以找出重复的 WHERE和ORDER BY子句。如果一个简单的WHERE子句返回结果所花 的时间太长，则可以断定其中使用的列（或几个列）就是需要索 引的对象</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/04/12/%E9%A2%9D/" rel="prev" title="额">
      <i class="fa fa-chevron-left"></i> 额
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7%E7%AB%A0"><span class="nav-number">1.</span> <span class="nav-text">1-7章</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC8%E7%AB%A0-%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="nav-number">2.</span> <span class="nav-text">第8章 用通配符进行过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">2.1.</span> <span class="nav-text">%通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">2.2.</span> <span class="nav-text">下划线通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E5%B7%A7"><span class="nav-number">2.3.</span> <span class="nav-text">技巧</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC9%E7%AB%A0-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E6%90%9C%E7%B4%A2"><span class="nav-number">3.</span> <span class="nav-text">第9章 正则表达式进行搜索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC10%E7%AB%A0-%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">4.</span> <span class="nav-text">第10章 创建计算字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC11%E7%AB%A0-%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">5.</span> <span class="nav-text">第11章 使用数据处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC12%E7%AB%A0-%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="nav-number">6.</span> <span class="nav-text">第12章 汇总数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AVG"><span class="nav-number">6.1.</span> <span class="nav-text">AVG()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#COUNT"><span class="nav-number">6.2.</span> <span class="nav-text">COUNT()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MAX-x2F-MIN"><span class="nav-number">6.3.</span> <span class="nav-text">MAX()&#x2F;MIN()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SUM"><span class="nav-number">6.4.</span> <span class="nav-text">SUM()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E4%B8%8D%E5%90%8C%E5%80%BC"><span class="nav-number">6.5.</span> <span class="nav-text">聚集不同值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC13%E7%AB%A0-%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="nav-number">7.</span> <span class="nav-text">第13章 分组数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC14%E7%AB%A0-%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">8.</span> <span class="nav-text">第14章 使用子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC15%E7%AB%A0-%E8%81%94%E7%BB%93%E8%A1%A8"><span class="nav-number">9.</span> <span class="nav-text">第15章 联结表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC16%E7%AB%A0-%E5%88%9B%E5%BB%BA%E9%AB%98%E7%BA%A7%E8%81%94%E7%BB%93"><span class="nav-number">10.</span> <span class="nav-text">第16章 创建高级联结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC17%E7%AB%A0-%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">11.</span> <span class="nav-text">第17章 组合查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC18%E7%AB%A0-%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="nav-number">12.</span> <span class="nav-text">第18章 全文本搜索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC19%E7%AB%A0-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">13.</span> <span class="nav-text">第19章 插入数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC20%E7%AB%A0-%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">14.</span> <span class="nav-text">第20章 更新和删除数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC21%E7%AB%A0-%E5%88%9B%E5%BB%BA%E5%92%8C%E6%93%8D%E7%BA%B5%E8%A1%A8"><span class="nav-number">15.</span> <span class="nav-text">第21章 创建和操纵表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">15.1.</span> <span class="nav-text">创建表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8"><span class="nav-number">15.2.</span> <span class="nav-text">更新表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8%E3%80%81%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="nav-number">15.3.</span> <span class="nav-text">删除表、重命名表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC22%E7%AB%A0-%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE%EF%BC%88-gt-x3D-MySQL-5%EF%BC%89"><span class="nav-number">16.</span> <span class="nav-text">第22章 使用视图（&gt;&#x3D; MySQL 5）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3"><span class="nav-number">16.1.</span> <span class="nav-text">理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%84%E5%88%99%E5%92%8C%E9%99%90%E5%88%B6"><span class="nav-number">16.2.</span> <span class="nav-text">规则和限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="nav-number">16.3.</span> <span class="nav-text">使用视图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC23%E7%AB%A0-%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-MySQL5"><span class="nav-number">17.</span> <span class="nav-text">第23章 使用存储过程(MySQL5)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC"><span class="nav-number">17.1.</span> <span class="nav-text">基本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="nav-number">17.2.</span> <span class="nav-text">使用参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC24%E7%AB%A0-%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87%EF%BC%88MySQL5%EF%BC%89"><span class="nav-number">18.</span> <span class="nav-text">第24章 使用游标（MySQL5）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC25%E7%AB%A0-%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88MySQL5%EF%BC%89"><span class="nav-number">19.</span> <span class="nav-text">第25章 使用触发器（MySQL5）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">19.1.</span> <span class="nav-text">创建触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">19.2.</span> <span class="nav-text">删除触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">19.3.</span> <span class="nav-text">使用触发器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC26%E7%AB%A0-%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="nav-number">20.</span> <span class="nav-text">第26章 管理事务处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC28%E7%AB%A0-%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="nav-number">21.</span> <span class="nav-text">第28章 安全管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC29%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%B4%E6%8A%A4"><span class="nav-number">22.</span> <span class="nav-text">第29章 数据库维护</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC30%E7%AB%A0-%E6%94%B9%E5%96%84%E6%80%A7%E8%83%BD"><span class="nav-number">23.</span> <span class="nav-text">第30章 改善性能</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Tien"
      src="https://github.com/account">
  <p class="site-author-name" itemprop="name">Tien</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tien</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
